[mirai-core](../../index.md) / [net.mamoe.mirai.event](../index.md) / [kotlinx.coroutines.CoroutineScope](./index.md)

### Extensions for kotlinx.coroutines.CoroutineScope
|||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [asyncFromEvent](async-from-event.md) | 异步监听这个事件, 并尝试从这个事件中获取一个值.`fun <E : `[`Event`](../-event/index.md)`, R : `[`Any`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html)`> CoroutineScope.asyncFromEvent(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)` = -1, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, priority: EventPriority = EventPriority.MONITOR, mapper: suspend E.(E) -> R?): Deferred<R>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [asyncFromEventOrNull](async-from-event-or-null.md) | 异步监听这个事件, 并尝试从这个事件中获取一个值.`fun <E : `[`Event`](../-event/index.md)`, R : `[`Any`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html)`> CoroutineScope.asyncFromEventOrNull(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, priority: EventPriority = EventPriority.MONITOR, mapper: suspend E.(E) -> R?): Deferred<R?>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [incoming](incoming.md) | 打开一个指定事件的接收通道`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.incoming(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, priority: EventPriority = EventPriority.MONITOR, capacity: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = Channel.UNLIMITED): ReceiveChannel<E>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [registerEvents](register-events.md) | 反射得到所有标注了 [EventHandler](../-event-handler/index.md) 的函数 (Java 为方法), 并注册为事件监听器`fun CoroutineScope.registerEvents(host: `[`ListenerHost`](../-listener-host.md)`, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribe](subscribe.md) | 在指定的 [协程作用域](#) 下创建一个事件监听器, 监听所有 [E](subscribe.md#E) 及其子类事件.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = LOCKED, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`ListeningStatus`](../-listening-status/index.md)`): `[`Listener`](../-listener/index.md)`<E>`<br>与 [CoroutineScope.subscribe](subscribe.md) 的区别是接受 [eventClass](subscribe.md#net.mamoe.mirai.event$subscribe(kotlinx.coroutines.CoroutineScope, kotlin.reflect.KClass((net.mamoe.mirai.event.subscribe.E)), kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, net.mamoe.mirai.event.Listener.EventPriority, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribe.E, , net.mamoe.mirai.event.ListeningStatus)))/eventClass) 参数, 而不使用 `reified` 泛型`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<out E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = LOCKED, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`ListeningStatus`](../-listening-status/index.md)`): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 带接收者的挂起函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(handler: (E) -> `[`ListeningStatus`](../-listening-status/index.md)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(handler: suspend E.(E) -> `[`ListeningStatus`](../-listening-status/index.md)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 带接收者的函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(handler: E.(E) -> `[`ListeningStatus`](../-listening-status/index.md)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 挂起函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribe(handler: suspend (E) -> `[`ListeningStatus`](../-listening-status/index.md)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeAlways](subscribe-always.md) | 在指定的 [CoroutineScope](#) 下订阅所有 [E](subscribe-always.md#E) 及其子类事件. 每当 [事件广播](../broadcast.md) 时, [handler](subscribe-always.md#net.mamoe.mirai.event$subscribeAlways(kotlinx.coroutines.CoroutineScope, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, net.mamoe.mirai.event.Listener.EventPriority, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeAlways.E, , kotlin.Unit)))/handler) 都会被执行.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = CONCURRENT, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../-listener/index.md)`<E>``fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<out E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = CONCURRENT, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 带接收者的挂起函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(handler: (E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(handler: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 带接收者的函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(handler: E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>`<br>支持 Kotlin 挂起函数的函数引用的监听方式.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeAlways(handler: suspend (E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, priority: EventPriority = NORMAL, concurrency: ConcurrencyKind = CONCURRENT, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): `[`Listener`](../-listener/index.md)`<E>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeFriendMessages](subscribe-friend-messages.md) | 订阅来自所有 [Bot](../../net.mamoe.mirai/-bot/index.md) 的所有好友消息事件`fun <R> CoroutineScope.subscribeFriendMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, priority: EventPriority = EventPriority.MONITOR, listeners: `[`FriendMessageSubscribersBuilder`](../-friend-message-subscribers-builder.md)`.() -> R): R` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeGroupMessages](subscribe-group-messages.md) | 订阅来自所有 [Bot](../../net.mamoe.mirai/-bot/index.md) 的所有群消息事件`fun <R> CoroutineScope.subscribeGroupMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, priority: EventPriority = EventPriority.MONITOR, listeners: `[`GroupMessageSubscribersBuilder`](../-group-message-subscribers-builder.md)`.() -> R): R` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeMessages](subscribe-messages.md) | 订阅来自所有 [Bot](../../net.mamoe.mirai/-bot/index.md) 的所有联系人的消息事件. 联系人可以是任意群或任意好友或临时会话.`fun <R> CoroutineScope.subscribeMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, priority: EventPriority = EventPriority.MONITOR, listeners: `[`MessagePacketSubscribersBuilder`](../-message-packet-subscribers-builder.md)`.() -> R): R` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeOnce](subscribe-once.md) | 在指定的 [CoroutineScope](#) 下订阅所有 [E](subscribe-once.md#E) 及其子类事件. 仅在第一次 [事件广播](../broadcast.md) 时, [handler](subscribe-once.md#net.mamoe.mirai.event$subscribeOnce(kotlinx.coroutines.CoroutineScope, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.EventPriority, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeOnce.E, , kotlin.Unit)))/handler) 会被执行.`fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeOnce(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../-listener/index.md)`<E>``fun <E : `[`Event`](../-event/index.md)`> CoroutineScope.subscribeOnce(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<out E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, priority: EventPriority = NORMAL, handler: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../-listener/index.md)`<E>` ||||
|:----------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [subscribeTempMessages](subscribe-temp-messages.md) | 订阅来自所有 [Bot](../../net.mamoe.mirai/-bot/index.md) 的所有临时会话消息事件`fun <R> CoroutineScope.subscribeTempMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, priority: EventPriority = EventPriority.MONITOR, listeners: `[`TempMessageSubscribersBuilder`](../-temp-message-subscribers-builder.md)`.() -> R): R` |

